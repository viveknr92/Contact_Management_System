<% include partials/header %>

<div class="container">
    <div class="jumbotron-fluid">
        <h1>Contact Manager</h1>
        <form action="/" method="GET">
            <div class="form-group">
                <input type="text" class="form-control" placeholder="Search" value="<%= search_query %>" name="search" id="searchValue" required>
            </div>
            <div>
                <button type="submit" class="btn btn-default" id="searchbutton">Search</button>
            </div>
        </form>
    </div>
    <hr>
    <div class="row">
        <a href="/addpage" class="btn btn-sm btn-success">Create New Contact</a>
    </div>
    <br/>
    <div class="row">
        <table class="table table-bordered table-striped">
            <thead class="thead-light">
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">First Name</th>
                    <th scope="col">Middle Name</th>
                    <th scope="col">Last Name</th>
                    <th scope="col"></th>
                </tr>
            </thead>
            <tbody id="searchQuery">
            <% if (search_result != null && search_result.length > 0) {%>
            <% console.log("view : " + search_result[0].fname); %>
            <p><%= count %> Contacts found</p>
            <% console.log("query : " + search_query); %>
            <% var editvar = null;  %>
            <% for(r of search_result) { %>
                    <tr>
                        <% console.log("view 2: " + JSON.stringify(r)); %>
                        <td><%= r.contact_id %></td>
                        <td><%= r.fname %></td>
                        <td><%= r.mname %></td>
                        <td><%= r.lname %></td>
                        <td><a href="/addpage?edit=<%= r.contact_id %>" class="btn btn-sm btn-success" id="editButton">Edit</button>
                            <a href="/delete/<%= r.contact_id %>" class="btn btn-sm btn-danger" id="deleteButton">Delete</a></td>
                    </tr>
            <% } %>
            </tbody>
        </table>
        <% } else { %>
            <p>No Contacts found</p>
        <% } %>
    </div>
</div>

<% include partials/footer %>