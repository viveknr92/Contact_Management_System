<% include partials/header %>

<div class="container">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="/">Contact Manager</a>
        <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
            <li class="nav-item active">
                <a href="/addpage" class="btn btn-success">Create Contact</a>
            </li>
        </ul>
        <form class="form-inline my-2 my-lg-0" action="/" method="GET">
            <input type="text" class="form-control mr-sm-2" type="search" placeholder="Search" value="<%= search_query %>" name="search" id="searchValue" required>
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit" id="searchbutton">Search</button>
        </form>
    </nav>
    <div class="row">
    <% if (search_result != null && search_result.length > 0) {%>
    <p><%= count %> Contacts found</p>
        <table class="table table-bordered table-striped">
            <thead class="thead-light">
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">First Name</th>
                    <th scope="col">Middle Name</th>
                    <th scope="col">Last Name</th>
                    <th scope="col">Action</th>
                </tr>
            </thead>
            <tbody id="searchQuery">
                
                <% console.log("view : " + search_result[0].fname); %>
                <% console.log("query : " + search_query); %>
                <% var editvar = null;  %>
                <% for(r of search_result) { %>
                <tr>
                    <% console.log("view 2: " + JSON.stringify(r)); %>
                    <td>
                        <%= r.contact_id %>
                    </td>
                    <td>
                        <%= r.fname %>
                    </td>
                    <td>
                        <%= r.mname %>
                    </td>
                    <td>
                        <%= r.lname %>
                    </td>
                    <td><a href="/addpage?edit=<%= r.contact_id %>" class="btn btn-sm btn-success" id="editButton">Edit</a>
                            <a href="/delete/<%= r.contact_id %>" class="btn btn-sm btn-danger" id="deleteButton">Delete</a></td>
                </tr>
                <% } %>
            </tbody>
        </table>
        <% }  %>
    </div>
</div>

<% include partials/footer %>